<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ROTA Service Status</title>
  <link href="https://fonts.googleapis.com/css2?family=Lato&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Lato', sans-serif;
      font-size: 11px;
      background: #f9f9f9;
      padding: 10px;
      margin: 0;
    }
    .status-box {
      border: 1px solid #ccc;
      padding: 12px;
      border-radius: 6px;
      width: fit-content;
      background-color: #fff;
      position: relative;
    }
    .grade {
      font-weight: bold;
      margin-bottom: 5px;
    }
    .timestamp {
      color: #777;
    }
    .reload-btn {
      margin-top: 8px;
      padding: 4px 10px;
      font-size: 11px;
      cursor: pointer;
      background-color: #eee;
      border: 1px solid #bbb;
      border-radius: 4px;
    }
    .reload-btn:hover {
      background-color: #ddd;
    }
    .spinner {
      display: none;
      width: 12px;
      height: 12px;
      border: 2px solid #ccc;
      border-top: 2px solid #555;
      border-radius: 50%;
      animation: spin 0.7s linear infinite;
      position: absolute;
      top: 12px;
      right: 12px;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div class="status-box">
    <div class="spinner" id="spinner"></div>
    <div class="grade" id="grade">Loading status...</div>
    <div class="timestamp" id="timestamp"></div>
    <button class="reload-btn" onclick="updateStatus()">Reload Status</button>
  </div>

  <script>
    const grades_peak = [
      "GRADE C-: System-wide delays due to weather and high traffic volume.",
      "GRADE D+: Limited service on several lines. Expect long delays and reroutes.",
      "GRADE D: Widespread disruption. Use caution and monitor alerts closely.",
      "GRADE D-: Minimal active service. Only essential routes operating under delay.",
      "GRADE F: All services temporarily suspended due to a major incident or emergency."
    ];

    const grades_offpeak = [
      "GRADE A+: All services are currently operating on schedule.",
      "GRADE A: Nearly all services are on time. Minor delays may occur due to light traffic.",
      "GRADE A-: Most services are running on schedule. A few minor delays reported in outskirts.",
      "GRADE B+: Some services are delayed due to moderate traffic. Core routes remain reliable.",
      "GRADE B: Several delays across the system. Riders may experience moderate wait times.",
      "GRADE B-: Frequent delays system-wide. Adjust travel plans where possible.",
      "GRADE C+: Routes are affected by scattered disruptions. Expect extended trip times.",
      "GRADE C: Major routes impacted by construction and traffic congestion.",
      "GRADE C-: System-wide delays due to weather and high traffic volume."
    ];

    function isPeakHour() {
      const hour = new Date().getHours();
      return (hour >= 7 && hour <= 9) || (hour >= 16 && hour <= 18);
    }

    function updateStatus() {
      const spinner = document.getElementById("spinner");
      spinner.style.display = "block";

      setTimeout(() => {
        const gradePool = isPeakHour() ? grades_peak : grades_offpeak;
        const selected = gradePool[Math.floor(Math.random() * gradePool.length)];

        const now = new Date();
        const time = now.toLocaleString('en-US', {
          month: 'short', day: '2-digit', year: 'numeric',
          hour: '2-digit', minute: '2-digit', hour12: true
        });

        document.getElementById("grade").innerText = selected;
        document.getElementById("timestamp").innerText = `(Last update: ${time})`;
        spinner.style.display = "none";
      }, 600); // Short delay to simulate loading
    }

    updateStatus();
    setInterval(updateStatus, 5 * 60 * 1000); // Update every 5 minutes
  </script>
</body>
</html>
